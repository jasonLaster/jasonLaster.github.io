<!DOCTYPE html>
<html><head><meta charset="utf-8"/><link rel="stylesheet" href="../../../assets/semantic.min.css"/><link rel="stylesheet" href="../../../assets/codemirror.css"/><link rel="stylesheet" href="../../../assets/flow-highlight-source.css"/><link rel="stylesheet" href="../../../assets/flow-coverage-report.css"/><link rel="stylesheet" href="../../../assets/codemirror-simplescrollbars-addon.css"/><script src="../../../assets/jquery-3.1.0.min.js"></script><script src="../../../assets/semantic.min.js"></script><script src="../../../assets/semantic-tablesort.js"></script><script src="../../../assets/codemirror.js"></script><script src="../../../assets/codemirror-javascript-mode.js"></script><script src="../../../assets/codemirror-annotatescrollbar-addon.js"></script><script src="../../../assets/codemirror-simplescrollbars-addon.js"></script><script src="../../../assets/flow-highlight-source.js"></script></head><body><div class="ui grid container"><div class="row"><h1 class="twelve wide column">Flow Coverage Report - src/actions/project-text-search.js</h1><div class="four wide column" style="height:32px;"><a href="../../../index.html" id="link-to-summary">Go back to all files summary.</a></div></div><div class="row"><table class="ui small celled unstackable table"><thead><tr><th class="sorted ascending">Filename</th><th>Percent</th><th>Total</th><th>Covered</th><th>Uncovered</th></tr></thead><tbody><tr class="negative"><td class="">src/actions/project-text-search.js</td><td> 71 %</td><td> 122 </td><td> 87 </td><td> 35 </td></tr></tbody></table></div><div class="row red" style="padding:0;height:12px;"></div><div class="row ui one column centered grid"><div class="column" style="text-align:left;"><div class="row"><div class="ui form"><div class="fields"><div class="sixteen wide inline field"><select class="ui search dropdown uncovered-locations"><option value="">Uncovered Locations</option><option value="46">Start: 46,5 - End: 46,40</option><option value="47">Start: 47,5 - End: 47,41</option><option value="49">Start: 49,11 - End: 49,17</option><option value="49">Start: 49,21 - End: 49,30</option><option value="49">Start: 49,21 - End: 49,42</option><option value="50">Start: 50,11 - End: 50,22</option><option value="50">Start: 50,26 - End: 50,32</option><option value="50">Start: 50,26 - End: 51,17</option><option value="50">Start: 50,26 - End: 55,7</option><option value="53">Start: 53,9 - End: 53,14</option><option value="54">Start: 54,40 - End: 54,45</option><option value="54">Start: 54,40 - End: 54,48</option><option value="54">Start: 54,68 - End: 54,73</option><option value="56">Start: 56,16 - End: 56,21</option><option value="56">Start: 56,26 - End: 56,37</option><option value="57">Start: 57,7 - End: 57,44</option><option value="57">Start: 57,37 - End: 57,42</option><option value="58">Start: 58,7 - End: 58,52</option><option value="58">Start: 58,35 - End: 58,40</option><option value="58">Start: 58,35 - End: 58,43</option><option value="66">Start: 66,11 - End: 66,22</option><option value="67">Start: 67,10 - End: 67,21</option><option value="71">Start: 71,11 - End: 71,17</option><option value="71">Start: 71,21 - End: 71,71</option><option value="71">Start: 71,27 - End: 71,43</option><option value="71">Start: 71,27 - End: 71,71</option><option value="71">Start: 71,45 - End: 71,56</option><option value="71">Start: 71,45 - End: 71,63</option><option value="72">Start: 72,10 - End: 72,16</option><option value="72">Start: 72,10 - End: 72,23</option><option value="78">Start: 78,19 - End: 78,30</option><option value="78">Start: 78,19 - End: 78,40</option><option value="79">Start: 79,19 - End: 79,30</option><option value="79">Start: 79,19 - End: 79,41</option><option value="80">Start: 80,9 - End: 80,15</option></select></div><div class="four wide inline field"><select class="ui search dropdown syntax-highlighting"><option value="es">ES6/ES7</option><option value="js">JavaScript</option><option value="no">None</option></select></div></div></div></div><textarea id="file-content" readonly="">/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at &lt;http://mozilla.org/MPL/2.0/&gt;. */

// @flow

/**
 * Redux actions for the search state
 * @module actions/search
 */

import { findSourceMatches } from &quot;../workers/search&quot;;
import { getSources, getSource, hasPrettySource } from &quot;../selectors&quot;;
import { isThirdParty } from &quot;../utils/source&quot;;
import { loadSourceText } from &quot;./sources&quot;;
import { statusType } from &quot;../reducers/project-text-search&quot;;

import type { ThunkArgs } from &quot;./types&quot;;

export function addSearchQuery(query: string) {
  return { type: &quot;ADD_QUERY&quot;, query };
}

export function clearSearchQuery() {
  return { type: &quot;CLEAR_QUERY&quot; };
}

export function clearSearchResults() {
  return { type: &quot;CLEAR_SEARCH_RESULTS&quot; };
}

export function clearSearch() {
  return { type: &quot;CLEAR_SEARCH&quot; };
}

export function updateSearchStatus(status: string) {
  return { type: &quot;UPDATE_STATUS&quot;, status };
}

export function closeProjectSearch() {
  return { type: &quot;CLOSE_PROJECT_SEARCH&quot; };
}

export function searchSources(query: string) {
  return async ({ dispatch, getState }: ThunkArgs) =&gt; {
    await dispatch(clearSearchResults());
    await dispatch(addSearchQuery(query));
    dispatch(updateSearchStatus(statusType.fetching));
    const sources = getSources(getState());
    const validSources = sources
      .valueSeq()
      .filter(
        source =&gt;
          !hasPrettySource(getState(), source.id) &amp;&amp; !isThirdParty(source)
      );
    for (const source of validSources) {
      await dispatch(loadSourceText(source));
      await dispatch(searchSource(source.id, query));
    }
    dispatch(updateSearchStatus(statusType.done));
  };
}

export function searchSource(sourceId: string, query: string) {
  return async ({ dispatch, getState }: ThunkArgs) =&gt; {
    const sourceRecord = getSource(getState(), sourceId);
    if (!sourceRecord) {
      return;
    }

    const matches = await findSourceMatches(sourceRecord.toJS(), query);
    if (!matches.length) {
      return;
    }
    dispatch({
      type: &quot;ADD_SEARCH_RESULT&quot;,
      result: {
        sourceId: sourceRecord.get(&quot;id&quot;),
        filepath: sourceRecord.get(&quot;url&quot;),
        matches
      }
    });
  };
}
</textarea></div></div><div class="row centered"><footer>Flow Coverage Report generated by<a href="https://flowtype.org"> flow </a>and<a href="https://github.com/rpl/flow-coverage-report"> flow-coverage-report </a>at Tue Apr 03 2018 15:58:53 GMT-0400 (EDT)</footer></div></div><pre id="file-coverage-data" style="display:none;">{&quot;expressions&quot;:{&quot;covered_count&quot;:87,&quot;uncovered_count&quot;:35,&quot;uncovered_locs&quot;:[{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:46,&quot;column&quot;:5,&quot;offset&quot;:1226},&quot;end&quot;:{&quot;line&quot;:46,&quot;column&quot;:40,&quot;offset&quot;:1262}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:47,&quot;column&quot;:5,&quot;offset&quot;:1268},&quot;end&quot;:{&quot;line&quot;:47,&quot;column&quot;:41,&quot;offset&quot;:1305}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:49,&quot;column&quot;:11,&quot;offset&quot;:1372},&quot;end&quot;:{&quot;line&quot;:49,&quot;column&quot;:17,&quot;offset&quot;:1379}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:49,&quot;column&quot;:21,&quot;offset&quot;:1382},&quot;end&quot;:{&quot;line&quot;:49,&quot;column&quot;:30,&quot;offset&quot;:1392}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:49,&quot;column&quot;:21,&quot;offset&quot;:1382},&quot;end&quot;:{&quot;line&quot;:49,&quot;column&quot;:42,&quot;offset&quot;:1404}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:50,&quot;column&quot;:11,&quot;offset&quot;:1416},&quot;end&quot;:{&quot;line&quot;:50,&quot;column&quot;:22,&quot;offset&quot;:1428}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:50,&quot;column&quot;:26,&quot;offset&quot;:1431},&quot;end&quot;:{&quot;line&quot;:50,&quot;column&quot;:32,&quot;offset&quot;:1438}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:50,&quot;column&quot;:26,&quot;offset&quot;:1431},&quot;end&quot;:{&quot;line&quot;:51,&quot;column&quot;:17,&quot;offset&quot;:1456}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:50,&quot;column&quot;:26,&quot;offset&quot;:1431},&quot;end&quot;:{&quot;line&quot;:55,&quot;column&quot;:7,&quot;offset&quot;:1572}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:53,&quot;column&quot;:9,&quot;offset&quot;:1480},&quot;end&quot;:{&quot;line&quot;:53,&quot;column&quot;:14,&quot;offset&quot;:1486}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:54,&quot;column&quot;:40,&quot;offset&quot;:1529},&quot;end&quot;:{&quot;line&quot;:54,&quot;column&quot;:45,&quot;offset&quot;:1535}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:54,&quot;column&quot;:40,&quot;offset&quot;:1529},&quot;end&quot;:{&quot;line&quot;:54,&quot;column&quot;:48,&quot;offset&quot;:1538}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:54,&quot;column&quot;:68,&quot;offset&quot;:1557},&quot;end&quot;:{&quot;line&quot;:54,&quot;column&quot;:73,&quot;offset&quot;:1563}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:56,&quot;column&quot;:16,&quot;offset&quot;:1589},&quot;end&quot;:{&quot;line&quot;:56,&quot;column&quot;:21,&quot;offset&quot;:1595}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:56,&quot;column&quot;:26,&quot;offset&quot;:1599},&quot;end&quot;:{&quot;line&quot;:56,&quot;column&quot;:37,&quot;offset&quot;:1611}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:57,&quot;column&quot;:7,&quot;offset&quot;:1621},&quot;end&quot;:{&quot;line&quot;:57,&quot;column&quot;:44,&quot;offset&quot;:1659}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:57,&quot;column&quot;:37,&quot;offset&quot;:1651},&quot;end&quot;:{&quot;line&quot;:57,&quot;column&quot;:42,&quot;offset&quot;:1657}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:58,&quot;column&quot;:7,&quot;offset&quot;:1667},&quot;end&quot;:{&quot;line&quot;:58,&quot;column&quot;:52,&quot;offset&quot;:1713}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:58,&quot;column&quot;:35,&quot;offset&quot;:1695},&quot;end&quot;:{&quot;line&quot;:58,&quot;column&quot;:40,&quot;offset&quot;:1701}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:58,&quot;column&quot;:35,&quot;offset&quot;:1695},&quot;end&quot;:{&quot;line&quot;:58,&quot;column&quot;:43,&quot;offset&quot;:1704}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:66,&quot;column&quot;:11,&quot;offset&quot;:1910},&quot;end&quot;:{&quot;line&quot;:66,&quot;column&quot;:22,&quot;offset&quot;:1922}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:67,&quot;column&quot;:10,&quot;offset&quot;:1967},&quot;end&quot;:{&quot;line&quot;:67,&quot;column&quot;:21,&quot;offset&quot;:1979}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:11,&quot;offset&quot;:2014},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:17,&quot;offset&quot;:2021}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:21,&quot;offset&quot;:2024},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:71,&quot;offset&quot;:2075}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:27,&quot;offset&quot;:2030},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:43,&quot;offset&quot;:2047}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:27,&quot;offset&quot;:2030},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:71,&quot;offset&quot;:2075}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:45,&quot;offset&quot;:2048},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:56,&quot;offset&quot;:2060}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:71,&quot;column&quot;:45,&quot;offset&quot;:2048},&quot;end&quot;:{&quot;line&quot;:71,&quot;column&quot;:63,&quot;offset&quot;:2067}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:72,&quot;column&quot;:10,&quot;offset&quot;:2086},&quot;end&quot;:{&quot;line&quot;:72,&quot;column&quot;:16,&quot;offset&quot;:2093}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:72,&quot;column&quot;:10,&quot;offset&quot;:2086},&quot;end&quot;:{&quot;line&quot;:72,&quot;column&quot;:23,&quot;offset&quot;:2100}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:78,&quot;column&quot;:19,&quot;offset&quot;:2206},&quot;end&quot;:{&quot;line&quot;:78,&quot;column&quot;:30,&quot;offset&quot;:2218}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:78,&quot;column&quot;:19,&quot;offset&quot;:2206},&quot;end&quot;:{&quot;line&quot;:78,&quot;column&quot;:40,&quot;offset&quot;:2228}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:79,&quot;column&quot;:19,&quot;offset&quot;:2248},&quot;end&quot;:{&quot;line&quot;:79,&quot;column&quot;:30,&quot;offset&quot;:2260}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:79,&quot;column&quot;:19,&quot;offset&quot;:2248},&quot;end&quot;:{&quot;line&quot;:79,&quot;column&quot;:41,&quot;offset&quot;:2271}},{&quot;source&quot;:&quot;/Users/jlaster/src/mozilla/debugger.html/src/actions/project-text-search.js&quot;,&quot;type&quot;:&quot;SourceFile&quot;,&quot;start&quot;:{&quot;line&quot;:80,&quot;column&quot;:9,&quot;offset&quot;:2281},&quot;end&quot;:{&quot;line&quot;:80,&quot;column&quot;:15,&quot;offset&quot;:2288}}]},&quot;percent&quot;:71}</pre></body></html>